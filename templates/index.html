<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üé¨ Movie Success Predictor</title>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg: #07080d; --surface: #0d1018; --surface2: #12161f;
      --border: #1c2130; --accent: #f5c518; --accent2: #e87040;
      --hit: #22c55e; --avg: #f5c518; --flop: #ef4444;
      --text: #e8edf5; --muted: #4a5568; --muted2: #718096;
    }
    html { scroll-behavior: smooth; }
    body { background: var(--bg); color: var(--text); font-family: 'DM Mono', monospace; min-height: 100vh; overflow-x: hidden; }
    body::before {
      content: ''; position: fixed; inset: 0;
      background-image: linear-gradient(rgba(245,197,24,0.02) 1px, transparent 1px), linear-gradient(90deg, rgba(245,197,24,0.02) 1px, transparent 1px);
      background-size: 44px 44px; pointer-events: none; z-index: 0;
    }
    .orb { position: fixed; border-radius: 50%; filter: blur(130px); pointer-events: none; z-index: 0; opacity: 0.18; }
    .orb-1 { width:600px; height:600px; background:#f5c518; top:-200px; right:-200px; animation: drift 14s ease-in-out infinite alternate; }
    .orb-2 { width:400px; height:400px; background:#e87040; bottom:-100px; left:-150px; animation: drift 18s ease-in-out infinite alternate-reverse; }
    @keyframes drift { from { transform:translate(0,0); } to { transform:translate(50px,50px); } }
    @keyframes fadeUp { from { opacity:0; transform:translateY(18px); } to { opacity:1; transform:translateY(0); } }
    @keyframes spin { to { transform:rotate(360deg); } }
    @keyframes pulse { 0%,100% { opacity:1; transform:scale(1); } 50% { opacity:0.4; transform:scale(0.7); } }

    .container { position:relative; z-index:1; max-width:980px; margin:0 auto; padding:56px 24px 80px; }

    header { margin-bottom:52px; animation:fadeUp .7s ease both; }
    .badge {
      display:inline-flex; align-items:center; gap:8px;
      background:rgba(245,197,24,0.08); border:1px solid rgba(245,197,24,0.22);
      border-radius:100px; padding:6px 14px;
      font-size:11px; letter-spacing:.1em; text-transform:uppercase; color:var(--accent); margin-bottom:20px;
    }
    .badge .dot { width:7px; height:7px; background:var(--accent); border-radius:50%; animation:pulse 2s ease-in-out infinite; }
    h1 {
      font-family:'Syne',sans-serif; font-size:clamp(34px,6vw,60px); font-weight:800;
      line-height:1.05; letter-spacing:-.02em;
      background:linear-gradient(135deg,#fff 0%,#a0b4cc 100%);
      -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; margin-bottom:14px;
    }
    h1 span { background:linear-gradient(135deg,var(--accent),var(--accent2)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
    .subtitle { color:var(--muted2); font-size:13px; line-height:1.7; max-width:520px; }

    .stats { display:flex; gap:1px; margin-bottom:44px; background:var(--border); border-radius:12px; overflow:hidden; animation:fadeUp .7s .1s ease both; }
    .stat { flex:1; background:var(--surface); padding:16px 18px; text-align:center; }
    .stat-value { font-family:'Syne',sans-serif; font-size:20px; font-weight:700; color:var(--accent); }
    .stat-label { font-size:9px; letter-spacing:.08em; text-transform:uppercase; color:var(--muted); margin-top:4px; }

    .section-title {
      font-family:'Syne',sans-serif; font-size:11px; font-weight:600;
      letter-spacing:.1em; text-transform:uppercase; color:var(--muted2);
      margin-bottom:14px; display:flex; align-items:center; gap:8px;
    }
    .section-title::before { content:''; display:block; width:3px; height:13px; background:var(--accent); border-radius:2px; }

    /* Examples */
    .examples-row { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-bottom:32px; animation:fadeUp .7s .15s ease both; }
    .example-card {
      background:var(--surface); border:1px solid var(--border);
      border-radius:14px; padding:18px 16px; cursor:pointer;
      transition:border-color .25s, transform .2s, box-shadow .2s;
      position:relative; overflow:hidden;
    }
    .example-card::before { content:''; position:absolute; inset:0; background:linear-gradient(135deg,rgba(245,197,24,0.05),transparent); opacity:0; transition:opacity .25s; }
    .example-card:hover { border-color:rgba(245,197,24,0.35); transform:translateY(-2px); box-shadow:0 8px 24px rgba(0,0,0,0.4); }
    .example-card:hover::before { opacity:1; }
    .ex-icon { font-size:24px; margin-bottom:10px; }
    .ex-title { font-family:'Syne',sans-serif; font-size:13px; font-weight:700; color:var(--text); margin-bottom:4px; }
    .ex-desc { font-size:10px; color:var(--muted2); line-height:1.5; margin-bottom:10px; }
    .ex-tag { display:inline-block; font-size:9px; font-weight:600; letter-spacing:.07em; text-transform:uppercase; padding:3px 9px; border-radius:100px; }
    .tag-hit { background:rgba(34,197,94,.15); color:var(--hit); border:1px solid rgba(34,197,94,.25); }
    .tag-avg { background:rgba(245,197,24,.15); color:var(--avg); border:1px solid rgba(245,197,24,.25); }
    .tag-flop { background:rgba(239,68,68,.15); color:var(--flop); border:1px solid rgba(239,68,68,.25); }
    .ex-fill-btn {
      position:absolute; top:12px; right:12px;
      background:rgba(245,197,24,0.1); border:1px solid rgba(245,197,24,0.2);
      border-radius:6px; padding:3px 8px; font-size:9px; color:var(--accent);
      letter-spacing:.05em; text-transform:uppercase; cursor:pointer; transition:background .2s;
    }
    .ex-fill-btn:hover { background:rgba(245,197,24,0.2); }

    /* Card */
    .card { background:var(--surface); border:1px solid var(--border); border-radius:16px; padding:28px; margin-bottom:20px; animation:fadeUp .7s .2s ease both; transition:border-color .3s; }
    .card:hover { border-color:rgba(245,197,24,0.15); }

    /* Section headers inside card */
    .input-section { margin-bottom:24px; }
    .input-section-title {
      font-family:'Syne',sans-serif; font-size:10px; font-weight:600;
      letter-spacing:.1em; text-transform:uppercase; color:var(--accent);
      margin-bottom:12px; padding-bottom:6px; border-bottom:1px solid var(--border);
    }

    /* Feature grid */
    .feature-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(175px,1fr)); gap:10px 12px; }
    .feature-wrap { display:flex; flex-direction:column; gap:5px; }
    .feature-label { font-size:9px; letter-spacing:.07em; text-transform:uppercase; color:var(--muted2); display:flex; align-items:center; gap:5px; }
    .feature-hint { font-size:9px; color:var(--muted); margin-top:2px; }
    .feature-input, .feature-select {
      background:var(--bg); border:1px solid var(--border);
      border-radius:8px; padding:9px 10px;
      color:var(--text); font-family:'DM Mono',monospace; font-size:12px;
      width:100%; outline:none; transition:border-color .2s, box-shadow .2s;
    }
    .feature-select { cursor:pointer; -webkit-appearance:none; appearance:none;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%23718096'/%3E%3C/svg%3E");
      background-repeat:no-repeat; background-position:right 10px center; padding-right:28px;
    }
    .feature-input:focus, .feature-select:focus { border-color:var(--accent); box-shadow:0 0 0 3px rgba(245,197,24,0.1); }
    .feature-select option { background:#0d1018; color:#e8edf5; }

    /* Buttons */
    .btn-row { display:flex; gap:10px; margin-top:24px; flex-wrap:wrap; }
    .btn { font-family:'Syne',sans-serif; font-size:13px; font-weight:600; letter-spacing:.03em; padding:12px 24px; border-radius:10px; border:none; cursor:pointer; transition:all .2s; display:inline-flex; align-items:center; gap:8px; }
    .btn-primary { background:var(--accent); color:#000; flex:1; justify-content:center; min-width:160px; }
    .btn-primary:hover { background:#ffd333; box-shadow:0 0 24px rgba(245,197,24,0.4); transform:translateY(-1px); }
    .btn-secondary { background:transparent; color:var(--muted2); border:1px solid var(--border); }
    .btn-secondary:hover { border-color:var(--accent2); color:var(--accent2); }
    .btn:disabled { opacity:.45; cursor:not-allowed; transform:none!important; box-shadow:none!important; }
    .spinner { width:15px; height:15px; border:2px solid rgba(0,0,0,.3); border-top-color:#000; border-radius:50%; animation:spin .7s linear infinite; display:none; }

    .error-msg { background:rgba(239,68,68,.08); border:1px solid rgba(239,68,68,.2); border-radius:10px; padding:12px 16px; color:#ef4444; font-size:12px; display:none; margin-top:14px; }

    /* Result */
    .result-card { background:var(--surface); border:1px solid var(--border); border-radius:16px; padding:28px; display:none; }
    .result-card.visible { display:block; animation:fadeUp .5s ease both; }
    .result-top { display:flex; align-items:center; gap:20px; margin-bottom:28px; }
    .result-badge { width:70px; height:70px; border-radius:16px; display:flex; align-items:center; justify-content:center; font-size:28px; flex-shrink:0; }
    .badge-hit { background:linear-gradient(135deg,#22c55e,#16a34a); box-shadow:0 0 28px rgba(34,197,94,0.3); }
    .badge-avg { background:linear-gradient(135deg,#f5c518,#d97706); box-shadow:0 0 28px rgba(245,197,24,0.3); }
    .badge-flop { background:linear-gradient(135deg,#ef4444,#b91c1c); box-shadow:0 0 28px rgba(239,68,68,0.3); }
    .result-meta .res-label { font-size:10px; letter-spacing:.1em; text-transform:uppercase; color:var(--muted2); margin-bottom:6px; }
    .result-classname { font-family:'Syne',sans-serif; font-size:30px; font-weight:800; }
    .classname-hit { color:var(--hit); } .classname-avg { color:var(--avg); } .classname-flop { color:var(--flop); }
    .prob-title { font-size:10px; letter-spacing:.08em; text-transform:uppercase; color:var(--muted2); margin-bottom:14px; }
    .prob-bars { display:flex; flex-direction:column; gap:12px; }
    .prob-row { display:flex; align-items:center; gap:12px; }
    .prob-name { font-size:11px; color:var(--muted2); width:60px; flex-shrink:0; }
    .prob-bar-bg { flex:1; height:8px; background:var(--bg); border-radius:100px; overflow:hidden; }
    .prob-bar-fill { height:100%; border-radius:100px; transition:width .9s cubic-bezier(.16,1,.3,1); width:0%; }
    .fill-hit { background:linear-gradient(90deg,#22c55e,#86efac); }
    .fill-avg { background:linear-gradient(90deg,#f5c518,#fde68a); }
    .fill-flop { background:linear-gradient(90deg,#ef4444,#fca5a5); }
    .prob-pct { font-size:12px; font-weight:500; color:var(--text); width:44px; text-align:right; }

    .bias-note { background:rgba(245,197,24,0.06); border:1px solid rgba(245,197,24,0.15); border-radius:10px; padding:10px 14px; font-size:11px; color:var(--muted2); margin-top:16px; }

    @media(max-width:600px) {
      .examples-row { grid-template-columns:1fr; }
      .stats { flex-wrap:wrap; }
      .feature-grid { grid-template-columns:repeat(2,1fr); }
    }
  </style>
</head>
<body>

<div class="orb orb-1"></div>
<div class="orb orb-2"></div>

<div class="container">

  <header>
    <div class="badge"><span class="dot"></span> Random Forest Classifier</div>
    <h1>Movie <span>Success</span><br/>Predictor</h1>
    <p class="subtitle">Predict whether a movie will be a <strong>Hit</strong>, <strong>Average</strong>, or <strong>Flop</strong> based on 26 production & social features. Powered by a trained RFC model with 90.7% accuracy.</p>
  </header>

  <div class="stats">
    <div class="stat"><div class="stat-value">RFC</div><div class="stat-label">Model</div></div>
    <div class="stat"><div class="stat-value">26</div><div class="stat-label">Features</div></div>
    <div class="stat"><div class="stat-value">3</div><div class="stat-label">Classes</div></div>
    <div class="stat"><div class="stat-value">90.7%</div><div class="stat-label">Accuracy</div></div>
    <div class="stat"><div class="stat-value">5043</div><div class="stat-label">Trained On</div></div>
  </div>

  <!-- Example movies -->
  <div class="section-title">Quick Examples ‚Äî Click to Auto-Fill</div>
  <div class="examples-row">
    <div class="example-card" onclick="fillExample(0)">
      <div class="ex-fill-btn">Auto-fill ‚Üó</div>
      <div class="ex-icon">üèÜ</div>
      <div class="ex-title">Avatar (2009)</div>
      <div class="ex-desc">Mega-budget sci-fi blockbuster. $237M budget, $760M gross, 1.2M votes.</div>
      <span class="ex-tag tag-hit">Expected: Hit</span>
    </div>
    <div class="example-card" onclick="fillExample(1)">
      <div class="ex-fill-btn">Auto-fill ‚Üó</div>
      <div class="ex-icon">üé≠</div>
      <div class="ex-title">Mid-Budget Drama</div>
      <div class="ex-desc">Modest drama with decent reviews, limited social buzz, $8M budget.</div>
      <span class="ex-tag tag-avg">Expected: Average</span>
    </div>
    <div class="example-card" onclick="fillExample(2)">
      <div class="ex-fill-btn">Auto-fill ‚Üó</div>
      <div class="ex-icon">üíÄ</div>
      <div class="ex-title">Low-Budget Horror</div>
      <div class="ex-desc">Poorly received horror, minimal votes, no social presence, $1.2M budget.</div>
      <span class="ex-tag tag-flop">Expected: Flop</span>
    </div>
  </div>

  <!-- Input card -->
  <div class="card">
    <div class="section-title">Movie Feature Inputs</div>

    <!-- Section 1: Basic Info -->
    <div class="input-section">
      <div class="input-section-title">üé¨ Basic Information</div>
      <div class="feature-grid" id="gridBasic"></div>
    </div>

    <!-- Section 2: Social & Reviews -->
    <div class="input-section">
      <div class="input-section-title">üìä Social Media & Reviews</div>
      <div class="feature-grid" id="gridSocial"></div>
    </div>

    <!-- Section 3: Financial -->
    <div class="input-section">
      <div class="input-section-title">üí∞ Financial Data</div>
      <div class="feature-grid" id="gridFinancial"></div>
    </div>

    <!-- Section 4: Genres -->
    <div class="input-section">
      <div class="input-section-title">üé≠ Genre Types</div>
      <div class="feature-grid" id="gridGenre"></div>
    </div>

    <div class="error-msg" id="errorMsg"></div>
    <div class="btn-row">
      <button class="btn btn-primary" id="predictBtn" onclick="runPredict()">
        <span class="spinner" id="spinner"></span>
        <span id="btnText">üé¨ Predict Movie Success</span>
      </button>
      <button class="btn btn-secondary" onclick="clearAll()">Clear All</button>
    </div>
  </div>

  <!-- Result card -->
  <div class="result-card" id="resultCard">
    <div class="section-title">Prediction Result</div>
    <div class="result-top">
      <div class="result-badge" id="resBadge">üé¨</div>
      <div class="result-meta">
        <div class="res-label">Predicted Outcome</div>
        <div class="result-classname" id="resClass">‚Äî</div>
      </div>
    </div>
    <div class="prob-title">Confidence per Class</div>
    <div class="prob-bars" id="probBars"></div>
    <div class="bias-note">‚ö†Ô∏è Note: The model was trained on imbalanced data (Hit: 68%, Average: 30%, Flop: 1%). Flop predictions may be underrepresented. Apply SMOTE in training to improve Flop recall.</div>
  </div>

</div>

<script>
// ‚îÄ‚îÄ Genre options (label encoded from LabelEncoder in notebook) ‚îÄ‚îÄ
const GENRE_OPTIONS = [
  ['None / Other', '0'],['Action','1'],['Adventure','2'],['Animation','3'],
  ['Biography','4'],['Comedy','5'],['Crime','6'],['Documentary','7'],
  ['Drama','8'],['Fantasy','9'],['Horror','10'],['Music','11'],
  ['Musical','12'],['Mystery','13'],['Romance','14'],['Sci-Fi','15'],
  ['Sport','16'],['Thriller','17'],['War','18'],['Western','19'],['Family','20']
];

// ‚îÄ‚îÄ Language options (approximate label encoding, English=11) ‚îÄ‚îÄ
const LANGUAGE_OPTIONS = [
  ['English', '11'], ['Hindi', '7'], ['French', '5'], ['Spanish', '20'],
  ['German', '6'], ['Japanese', '10'], ['Mandarin', '14'], ['Italian', '9'],
  ['Korean', '12'], ['Portuguese', '16'], ['Arabic', '0'], ['Russian', '18'],
  ['Other', '3']
];

// ‚îÄ‚îÄ Country options (approximate label encoding, USA=62) ‚îÄ‚îÄ
const COUNTRY_OPTIONS = [
  ['USA', '62'], ['India', '8'], ['UK', '60'], ['France', '5'],
  ['Germany', '6'], ['Australia', '1'], ['Canada', '3'], ['Japan', '10'],
  ['China', '4'], ['South Korea', '22'], ['Italy', '9'], ['Spain', '21'],
  ['Brazil', '2'], ['Mexico', '14'], ['Russia', '19'], ['Other', '0']
];

// ‚îÄ‚îÄ Content Rating options ‚îÄ‚îÄ
const RATING_OPTIONS = [
  ['G', '2'], ['PG', '6'], ['PG-13', '7'], ['R', '3'],
  ['NC-17', '5'], ['Not Rated', '8'], ['Unrated', '4'], ['TV-14', '0'],
  ['TV-MA', '1']
];

// ‚îÄ‚îÄ Feature definitions organized by section ‚îÄ‚îÄ
// key, label, type, placeholder, hint, options (for select)
const FEATURES_BASIC = [
  { key:'color',          label:'Color Format',      type:'select',  options:[['Color','1'],['Black & White','0']] },
  { key:'duration',       label:'Duration (min)',     type:'number',  placeholder:'107', hint:'60 ‚Äì 511 mins' },
  { key:'title_year',     label:'Release Year',       type:'number',  placeholder:'2009', hint:'1916 ‚Äì 2016' },
  { key:'language',       label:'Language',           type:'select',  options: LANGUAGE_OPTIONS },
  { key:'country',        label:'Country',            type:'select',  options: COUNTRY_OPTIONS },
  { key:'content_rating', label:'Content Rating',     type:'select',  options: RATING_OPTIONS },
  { key:'aspect_ratio',   label:'Aspect Ratio',       type:'number',  placeholder:'2.35', hint:'e.g. 1.33, 1.78, 1.85, 2.35' },
  { key:'facenumber_in_poster', label:'Faces in Poster', type:'number', placeholder:'1', hint:'0 ‚Äì 43' },
];

const FEATURES_SOCIAL = [
  { key:'num_critic_for_reviews',    label:'Critic Reviews',       type:'number', placeholder:'140',   hint:'No. of critic reviews (50‚Äì813)' },
  { key:'num_user_for_reviews',      label:'User Reviews',         type:'number', placeholder:'272',   hint:'No. of user reviews (1‚Äì5060)' },
  { key:'num_voted_users',           label:'IMDB Votes',           type:'number', placeholder:'83668', hint:'No. of IMDB voters' },
  { key:'director_facebook_likes',   label:'Director FB Likes',    type:'number', placeholder:'686',   hint:'Director Facebook page likes' },
  { key:'actor_2_facebook_likes',    label:'Actor 2 FB Likes',     type:'number', placeholder:'1652',  hint:'2nd lead actor FB likes' },
  { key:'actor_3_facebook_likes',    label:'Actor 3 FB Likes',     type:'number', placeholder:'645',   hint:'3rd actor FB likes' },
  { key:'cast_total_facebook_likes', label:'Cast Total FB Likes',  type:'number', placeholder:'9699',  hint:'Total FB likes of all cast' },
  { key:'movie_facebook_likes',      label:'Movie FB Likes',       type:'number', placeholder:'7525',  hint:'Movie page FB likes' },
];

const FEATURES_FINANCIAL = [
  { key:'gross',   label:'Gross Earnings ($)', type:'number', placeholder:'48468412',  hint:'Total box office gross in USD' },
  { key:'budget',  label:'Production Budget ($)', type:'number', placeholder:'39752624', hint:'Total production budget in USD' },
];

const FEATURES_GENRE = [
  { key:'genre_type1', label:'Primary Genre',   type:'select', options: GENRE_OPTIONS },
  { key:'genre_type2', label:'Genre 2',         type:'select', options: GENRE_OPTIONS },
  { key:'genre_type3', label:'Genre 3',         type:'select', options: GENRE_OPTIONS },
  { key:'genre_type4', label:'Genre 4',         type:'select', options: GENRE_OPTIONS },
  { key:'genre_type5', label:'Genre 5',         type:'select', options: GENRE_OPTIONS },
  { key:'genre_type6', label:'Genre 6',         type:'select', options: GENRE_OPTIONS },
  { key:'genre_type7', label:'Genre 7',         type:'select', options: GENRE_OPTIONS },
  { key:'genre_type8', label:'Genre 8',         type:'select', options: GENRE_OPTIONS },
];

// Flat ordered list for prediction (must match training order exactly)
const FEATURE_ORDER = [
  'color','num_critic_for_reviews','duration','director_facebook_likes',
  'actor_3_facebook_likes','gross',
  'genre_type1','genre_type2','genre_type3','genre_type4',
  'genre_type5','genre_type6','genre_type7','genre_type8',
  'num_voted_users','cast_total_facebook_likes','facenumber_in_poster',
  'num_user_for_reviews','language','country','content_rating',
  'budget','title_year','actor_2_facebook_likes','aspect_ratio','movie_facebook_likes'
];

function buildGrid(containerId, features) {
  const grid = document.getElementById(containerId);
  features.forEach(f => {
    const wrap = document.createElement('div');
    wrap.className = 'feature-wrap';
    if (f.type === 'select') {
      wrap.innerHTML = `
        <label class="feature-label">${f.label}</label>
        <select class="feature-select" id="f_${f.key}">
          ${f.options.map(([l,v]) => `<option value="${v}">${l}</option>`).join('')}
        </select>`;
    } else {
      wrap.innerHTML = `
        <label class="feature-label">${f.label}</label>
        <input class="feature-input" id="f_${f.key}" type="number" step="any" placeholder="${f.placeholder}"/>
        ${f.hint ? `<span class="feature-hint">${f.hint}</span>` : ''}`;
    }
    grid.appendChild(wrap);
  });
}

buildGrid('gridBasic',     FEATURES_BASIC);
buildGrid('gridSocial',    FEATURES_SOCIAL);
buildGrid('gridFinancial', FEATURES_FINANCIAL);
buildGrid('gridGenre',     FEATURES_GENRE);

// ‚îÄ‚îÄ 3 Example presets ‚îÄ‚îÄ
const EXAMPLES = [
  // Avatar (2009) ‚Äî Hit
  {
    color:'1', num_critic_for_reviews:'723', duration:'178', director_facebook_likes:'0',
    actor_3_facebook_likes:'855', gross:'760505847',
    genre_type1:'15', genre_type2:'1', genre_type3:'7', genre_type4:'20',
    genre_type5:'0', genre_type6:'0', genre_type7:'0', genre_type8:'0',
    num_voted_users:'1200000', cast_total_facebook_likes:'4834', facenumber_in_poster:'0',
    num_user_for_reviews:'3054', language:'11', country:'62', content_rating:'7',
    budget:'237000000', title_year:'2009', actor_2_facebook_likes:'936', aspect_ratio:'1.78', movie_facebook_likes:'33000'
  },
  // Mid-Budget Drama ‚Äî Average
  {
    color:'1', num_critic_for_reviews:'55', duration:'98', director_facebook_likes:'30',
    actor_3_facebook_likes:'120', gross:'12000000',
    genre_type1:'8', genre_type2:'0', genre_type3:'0', genre_type4:'0',
    genre_type5:'0', genre_type6:'0', genre_type7:'0', genre_type8:'0',
    num_voted_users:'18000', cast_total_facebook_likes:'1200', facenumber_in_poster:'1',
    num_user_for_reviews:'90', language:'11', country:'62', content_rating:'7',
    budget:'8000000', title_year:'2010', actor_2_facebook_likes:'400', aspect_ratio:'1.85', movie_facebook_likes:'500'
  },
  // Low-Budget Horror ‚Äî Flop
  {
    color:'1', num_critic_for_reviews:'12', duration:'84', director_facebook_likes:'5',
    actor_3_facebook_likes:'40', gross:'900000',
    genre_type1:'10', genre_type2:'0', genre_type3:'0', genre_type4:'0',
    genre_type5:'0', genre_type6:'0', genre_type7:'0', genre_type8:'0',
    num_voted_users:'3200', cast_total_facebook_likes:'300', facenumber_in_poster:'2',
    num_user_for_reviews:'25', language:'11', country:'62', content_rating:'3',
    budget:'1200000', title_year:'2004', actor_2_facebook_likes:'100', aspect_ratio:'1.85', movie_facebook_likes:'120'
  }
];

function fillExample(idx) {
  const ex = EXAMPLES[idx];
  Object.keys(ex).forEach(key => {
    const el = document.getElementById('f_' + key);
    if (el) el.value = ex[key];
  });
  hideError();
  document.getElementById('resultCard').classList.remove('visible');
  document.querySelector('.card').scrollIntoView({ behavior:'smooth', block:'start' });
}

function clearAll() {
  [...FEATURES_BASIC, ...FEATURES_SOCIAL, ...FEATURES_FINANCIAL, ...FEATURES_GENRE].forEach(f => {
    const el = document.getElementById('f_' + f.key);
    if (el) el.value = '';
  });
  document.getElementById('resultCard').classList.remove('visible');
  hideError();
}

function showError(msg) { const e = document.getElementById('errorMsg'); e.textContent = msg; e.style.display = 'block'; }
function hideError() { document.getElementById('errorMsg').style.display = 'none'; }
function setLoading(on) {
  document.getElementById('spinner').style.display = on ? 'block' : 'none';
  document.getElementById('btnText').textContent = on ? 'Predicting...' : 'üé¨ Predict Movie Success';
  document.getElementById('predictBtn').disabled = on;
}

async function runPredict() {
  hideError();
  const features = [];
  const missing = [];

  FEATURE_ORDER.forEach(key => {
    const el = document.getElementById('f_' + key);
    const v = el ? el.value : '';
    if (v === '' || v === null) {
      missing.push(key);
      features.push(0);
    } else {
      features.push(parseFloat(v));
    }
  });

  if (missing.length > 0) {
    showError(`Please fill all fields. Missing: ${missing.slice(0,4).join(', ')}${missing.length > 4 ? ` and ${missing.length-4} more...` : ''}`);
    return;
  }

  setLoading(true);
  try {
    const res = await fetch('/predict', {
      method:'POST', headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ features })
    });
    const data = await res.json();
    if (data.error) { showError('Server error: ' + data.error); setLoading(false); return; }
    renderResult(data);
  } catch(err) {
    showError('Cannot connect to Flask server. Make sure app.py is running on localhost:5000.');
  }
  setLoading(false);
}

const CLASS_CONFIG = {
  'Hit':     { icon:'üèÜ', badgeClass:'badge-hit',  nameClass:'classname-hit',  fillClass:'fill-hit' },
  'Average': { icon:'üé≠', badgeClass:'badge-avg',  nameClass:'classname-avg',  fillClass:'fill-avg' },
  'Flop':    { icon:'üíÄ', badgeClass:'badge-flop', nameClass:'classname-flop', fillClass:'fill-flop' },
};

function renderResult(data) {
  const cls = data.predicted_class;
  const cfg = CLASS_CONFIG[cls] || { icon:'üé¨', badgeClass:'badge-avg', nameClass:'', fillClass:'' };

  const badge = document.getElementById('resBadge');
  badge.textContent = cfg.icon;
  badge.className = 'result-badge ' + cfg.badgeClass;

  const nameEl = document.getElementById('resClass');
  nameEl.textContent = cls;
  nameEl.className = 'result-classname ' + cfg.nameClass;

  const probBars = document.getElementById('probBars');
  probBars.innerHTML = '';
  Object.entries(data.probabilities).forEach(([label, prob]) => {
    const pct = (prob * 100).toFixed(1);
    const fillCls = (CLASS_CONFIG[label] || {}).fillClass || 'fill-avg';
    const row = document.createElement('div');
    row.className = 'prob-row';
    row.innerHTML = `
      <span class="prob-name">${label}</span>
      <div class="prob-bar-bg"><div class="prob-bar-fill ${fillCls}" id="bar_${label}" style="width:0%"></div></div>
      <span class="prob-pct">${pct}%</span>`;
    probBars.appendChild(row);
  });

  document.getElementById('resultCard').classList.add('visible');
  document.getElementById('resultCard').scrollIntoView({ behavior:'smooth', block:'start' });

  requestAnimationFrame(() => {
    Object.entries(data.probabilities).forEach(([label, prob], i) => {
      setTimeout(() => {
        const bar = document.getElementById('bar_' + label);
        if (bar) bar.style.width = (prob * 100) + '%';
      }, i * 120);
    });
  });
}
</script>
</body>
</html>
